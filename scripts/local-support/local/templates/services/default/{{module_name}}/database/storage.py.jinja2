import logging

import async_database_postgresql.storage as base_storage

logger = logging.getLogger(__name__)


class Storage(base_storage.Storage):
    async def get_current_database(self) -> str:
        result = await self.execute("SELECT current_database()")
        return result.scalar()
